---
title: "d_calc: converting studies into d or ∆ estimates"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{d-calc-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Converting a study into a point estimate and its variance

## 1 Introduction

This vignette walks through the process of converting a study's reported results into an estimate of standardized mean difference (SMD) and its associated variance using `d_calc` and `var_d_calc`. We demonstrate with examples from our prior meta-analyses: mostly [The Contact Hypothesis Re-evaluated](https://doi.org/10.1017/bpp.2018.25), with a few examples drawn from [Preventing Sexual Violence —A Behavioral Problem Without a Behaviorally-Informed Solution](https://osf.io/preprints/psyarxiv/xgbzj).

In general, an SMD is $\frac{M1-M2}{SD}$: the difference in average outcomes between two groups divided by the standard deviation (SD) of the outcome.

Some studies present these pieces of information plainly, which makes calculating the SMD easy. Others report statistical summaries, which then need to be converted into SMDs. Once you have the SMD, you can calculate its variance and standard error to give a sense of how precise that estimate is. Your meta-analysis then takes these variables as inputs and returns a pooled average effect that gives more weight to more precise estimates.

Our functions generally implement equations from chapters 12 and 13 [Cooper, Hedges, and Valentine (2009)](https://www.scholars.northwestern.edu/en/publications/the-handbook-of-research-synthesis-and-meta-analysis-2nd-edition). In one case (the difference in proportions estimator), we depart from those equations, which we'll explain when we get to it.

If you standardize your SMD with the estimated SD of the outcome for the entire population, your estimator is called [Cohen's d](https://resources.nu.edu/statsresources/cohensd). If you use an estimated SD from just the control group, you get [Glass's ∆](https://www.statisticshowto.com/glasss-delta/) (Delta). The Paluck lab generally prefers Glass's ∆ because we're interested in the efficacy of interventions relative to the population's baseline state. When the SD of the control group isn't available, we use the SD of the entire population. When neither is available, or can't be figured out from the statistics a paper presents, we have a problem (we'll get to that later). In this vignette, we use ∆ as our symbol for SMD.

How to convert statistical results into SMDs is an active debate among researchers. In some cases, our conversion formulas are going to imperfectly capture the true SMD because we don't have access to the raw data. But we live in a world with imperfect data availability [data are not always available](data-are-not-available-upon-request], we think these equations represent a reasonable balance between, on the one hand, capturing overall directional effect of studies we meta-analyze and, on the other, not excluding too many studies for reporting limitations.

See [this page on SMDs](https://handbook-5-1.cochrane.org/chapter_9/9_2_3_2_the_standardized_mean_difference.htm) from the Cochrane collaboration and the `escalc` documentation from Wolfgang Viechtbauer's `metafor` package for further reading.

## 2 the functions

### 2.1 `d_calc`

`d_calc` is a function that takes (up to) five parameters and returns an SMD. The first two are essential, and the next three are necessary depending on the value of the first parameter.

Those parameters are:

-   `stat_type` , where you should put the kind of statistical results you're converting into SMD. its possible values are:

    -   `d` or `s_m_d`, for when a paper provides its own estimate of d/∆/SMD.

    -   `d_i_m` for difference in means.

    -   `d_i_d` for difference in differences.

    -   `reg_coef`, `regression`, or `beta`, for when you have the regression coefficient associated with treatment.

    -   `t_test` or `T-test` for when you have a t-test.

    -   `f_test` or `F-test` or `F` for when you have an F-test.

    -   `odds_ratio` for odds ratio.

    -   `log_odds_ratio` for log odds ratio.

    -   `d_i_p` for a difference in proportions.

    -   `unspecified_null` or `unspecified null` for when you can't figure out a precise estimate, but know that the overall effect was null.

-   `stat`, the value of the statistic that you're reporting or converting into SMD.

-   `sample_sd`, the standard deviation that you're using to standardize your estimate.

    -   This is generally a needed input, but not when the stat type already tells you something about the variance of the outcome (d, SMD, F test, t test, odds ratio, or log odds ratio).

-   `n_t` and `n_c`, the sample sizes for treatment and control.

    -   These are necessary only for converting t test and F test results into SMDs.

### 2.1 `var_d_calc`

## 3. Using `d_calc` and `var_d_calc` 

###  Best case scenario: the difference in means and standard deviation, or even the SMD, are stated plainly.

### Conversions

#### a novel estimator

### Taking a good guess based on what's available

## how we use `d_calc` and `var_d_calc` in practice
